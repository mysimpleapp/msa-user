<link rel="import" href="/msa/msa.html"></link>
<style>
msa-user-first-register {
	flex: 1;
}
msa-user-first-register table {
	width: 100%;
	text-align: center;
	padding: 10px;
}
msa-user-first-register .title {
	font-weight: bold;
	padding: 5px;
	font-size: 20px;
}
</style>
<template id="msa-user-first-register">
	<table>
		<tr><td class="title">Register the admin user</td></tr>
		<tr><td><input type=text name="name" placeholder="username"></td></tr>
		<tr><td><input type=password name="pass" placeholder="password"></td></tr>
		<tr><td><input type=text name="email" placeholder="email"></td></tr>
		<tr><td><button class="register">Register</button></td></tr>
	</table>
</template>
<script>
(function() {

	// actions
	var registerActions = []
	registerActions.push({el:"button.register", evt:"click", act:function() {
		var name = this.Q("input[name=name]").value,
			pass = this.Q("input[name=pass]").value,
			email = this.Q("input[name=email]").value
		Msa.post('/user/firstregister',
			{body:{name:name, pass:pass, email:email}},
			function(user) {
				if(user) document.location = "/"
			}
		)
	}})

	// register elements
	Msa.registerElement("msa-user-first-register", {
		template: "#msa-user-first-register",
		oncreate: function() {
			this.Q = Msa.Q
			Msa.addActions(this, registerActions)
		}
	})
})()
</script>
